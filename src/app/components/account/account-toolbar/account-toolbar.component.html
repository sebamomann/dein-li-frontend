<div class="account-menu-wrapper">
  <div class="account-username-button" *ngIf="refreshing || (!refreshing && userIsLoggedIn)">
    <div *ngIf="!refreshing"
         [@appearSidewards]="{value: '', params: {delay: refreshingOnInit ? (500 + 750) : 500}}"
         [matMenuTriggerFor]="menu"
         #menuTrigger="matMenuTrigger"
         class="stroked-button-colored">
      <span>{{username}}</span>
    </div>
    <mat-icon *ngIf="!refreshing"
              [@appearScale]="{value: '', params: {delay: refreshingOnInit ? 500 : 0}}">
      account_circle
    </mat-icon>
    <mat-icon *ngIf="refreshing"
              [@removeScale]
              class="spin">
      refresh
    </mat-icon>
  </div>

  <mat-menu #menu="matMenu" xPosition="before">
    <ng-container [ngTemplateOutlet]="loggedInMenu">
    </ng-container>
  </mat-menu>

  <ng-container *ngIf="!userIsLoggedIn && !refreshing">
    <div>
      <button (click)="login()"
              class="stroked-button-colored"
              mat-stroked-button>
        <span>Login</span>
        <mat-icon>login</mat-icon>
      </button>
    </div>
  </ng-container>
</div>

<ng-template #loggedInMenu>
  <button mat-menu-item
          (click)="openAccountSettings()">
    <mat-icon>person</mat-icon>
    Profil
  </button>
  <button mat-menu-item
          [routerLink]="['/link']">
    <mat-icon>link</mat-icon>
    Meine Links
  </button>
  <button mat-menu-item
          (click)="logout()">
    <mat-icon>logout</mat-icon>
    Abmelden
  </button>
</ng-template>
